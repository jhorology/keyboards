diff --git a/quantum/action.c b/quantum/action.c
index aacafbe2ff..5483ea3059 100644
--- a/quantum/action.c
+++ b/quantum/action.c
@@ -304,7 +304,7 @@ void process_record(keyrecord_t *record) {
 }
 
 void process_record_handler(keyrecord_t *record) {
-#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE)
+#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE) || defined(ACTION_FOR_KEYCODE_ENABLE)
     action_t action;
     if (record->keycode) {
         action = action_for_keycode(record->keycode);
diff --git a/quantum/action.h b/quantum/action.h
index a459c438c1..eb3ccd4ed6 100644
--- a/quantum/action.h
+++ b/quantum/action.h
@@ -50,7 +50,7 @@ typedef struct keyrecord_t {
 #ifndef NO_ACTION_TAPPING
     tap_t tap;
 #endif
-#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE)
+#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE) || defined(ACTION_FOR_KEYCODE_ENABLE)
     uint16_t keycode;
 #endif
 } keyrecord_t;
diff --git a/quantum/quantum.c b/quantum/quantum.c
index 128f8fb66d..771c68dedc 100644
--- a/quantum/quantum.c
+++ b/quantum/quantum.c
@@ -247,7 +247,7 @@ void soft_reset_keyboard(void) {
 
 /* Convert record into usable keycode via the contained event. */
 uint16_t get_record_keycode(keyrecord_t *record, bool update_layer_cache) {
-#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE)
+#if defined(COMBO_ENABLE) || defined(REPEAT_KEY_ENABLE) || defined(ACTION_FOR_KEYCODE_ENABLE)
     if (record->keycode) {
         return record->keycode;
     }
